<turbo-stream action="replace" target="reservationModal-{{ desk.id }}">
    <template>
        <div id="reservationModal-{{ desk.id }}" class="hidden"></div>
    </template>
</turbo-stream>

<turbo-stream action="prepend" target="flash-messages">
    <template>
        {% include 'shared/components/_flash_message.html.twig' with {
            message: 'Reservation created successfully!',
            type: 'success'
        } %}
    </template>
</turbo-stream>

<turbo-stream action="redirect" target="_top">
    <template>{{ path('app_space_show', {'id': desk.space.id}) }}</template>
</turbo-stream>

<script>
    // Close the modal programmatically
    console.log('Reservation created for desk {{ desk.id }}');

    // Hide the modal
    const modal = document.getElementById('reservationModal-{{ desk.id }}');
    if (modal) {
        modal.classList.add('hidden');
        modal.setAttribute('aria-hidden', 'true');
    }

    // Hide the modal backdrop if it exists
    const backdrop = document.querySelector('.bg-white\\/50.dark\\:bg-gray-900\\/50');
    if (backdrop) {
        backdrop.remove();
    }

    // Remove any open modal classes from the body
    document.body.classList.remove('overflow-hidden');

    // Redirect to the space page
    setTimeout(function() {
        window.location.href = '{{ path('app_space_show', {'id': desk.space.id}) }}';
    }, 500);
</script>
